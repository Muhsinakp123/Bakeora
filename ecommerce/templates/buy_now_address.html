{% extends "base.html" %}
{% block content %}

<section class="container py-5">

  <h3 class="mb-4 fw-bold">Select Delivery Address</h3>

  <div class="mb-4">
      <strong>Product:</strong> {{ product.name }} <br>
      <strong>Price:</strong> ₹{{ product.price }}
  </div>

  {% if addresses %}

    {% for address in addresses %}
    <div class="card mb-3 shadow-sm p-3">
        <h5>{{ address.full_name }}</h5>
        <p class="mb-1">
            {{ address.address_line }}<br>
            {{ address.city }} - {{ address.pincode }}
        </p>
        <p class="mb-2">Phone: {{ address.phone }}</p>

<form method="POST" action="{% url 'buy_now_create_order' address.id product_type product_id %}">
    {% csrf_token %}
    <button type="submit" class="btn btn-warning btn-sm">
        Deliver Here
    </button>
</form>

    </div>
    {% endfor %}

    <!-- ✅ CORRECT ADD ADDRESS LINK -->
    <a href="{% url 'add_address' %}" class="btn btn-outline-dark mt-3">
        Add New Address
    </a>

  {% else %}

    <div class="card p-4 text-center shadow-sm">
        <p>No saved address found.</p>
        <a href="{% url 'add_address' %}" class="btn btn-warning">
            Add Address
        </a>
    </div>

  {% endif %}

</section>

{% endblock %}
